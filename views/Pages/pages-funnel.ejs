<%- contentFor('HeaderCss') %> 

<%- contentFor('breadcrumb') %>
<ul class="list-inline menu-left mb-0">
    <li class="list-inline-item">
        <button type="button" class="button-menu-mobile open-left waves-effect">
            <i class="ion-navicon"></i>
        </button>
    </li>
    
    <li class="hide-phone list-inline-item app-search">
        <h3 class="page-title">Funnel</h3>
        <button type="button" class="btn btn-primary waves-effect waves-light" data-toggle="modal" data-target="#addProject" id="btnAddProject">Add FunnelProject</button>
        
    </li>
</ul>

<%- contentFor('body') %>

<div class="page-content-wrapper">
  <div class="container-fluid">
    <div class="row">
      <!-- Main content -->
      <div class="col-md-12"></div>

      <!-- Radar and Flight Plan Buttons -->
      <div class="col-md-12">
        <div class="mini-stat bg-white clearfix">
          <div>
           <!-- Priority Section -->
           <div class="col-md-12">
            <div class="mini-stat bg-white clearfix" style="min-height: 150px;">
                <div class="mini-stat-info">
                    <span class="counter">Funnel (<%= pitchCount %>, $<%= pitchTotalCost %>, <%= pitchTotalPH %> PH)</span>
                </div>
                <div>
                    <% projects.forEach(function(project) { %>
                        <% if (project.phase_name.trim() === 'Pitch') { %>
                            <span>
                                <button type="button" onclick="loadProject('<%= project.id %>')" class="btn btn-light" style="margin-bottom: 10px; border-color: <%= project.health %>; border-width: 2px;border-radius:10px;">
                                    <%= project.project_name %>
                                </button>
                            </span>&nbsp;&nbsp;&nbsp;
                        <% } %>
                    <% }); %>
                </div>
            </div>
        </div>
               
            </button>
          </div>
        </div>
       <!-- project modal content -->
       <div id="addProject" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content" style="width: 900px;">
                <div class="modal-header">
                    <h5 class="modal-title mt-0">Add Project</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                </div>
                <div class="modal-body">
                    <form action="/projects" class="needs-validation" novalidate method="POST">
                      <div class="container">
                        <div class="row">
                          <div class="col-md-6">
                            <!-- First column of form fields -->
                            <div class="form-group">
                              <label for="project_name">Name</label>
                              <input type="text" class="form-control" id="project_name" name="project_name" required>
                              <div class="invalid-feedback">
                                Please enter project name.
                              </div>
                            </div>
                            <div class="form-group">
                              <label for="project_headline">Headline</label>
                              <input type="text" class="form-control" id="project_headline" name="project_headline">
                            </div>
                            <div id="leftElements">
                              <div class="form-group">
                                <label for="project_why">Why?</label>
                                <textarea rows="4" class="form-control" id="project_why" name="project_why"></textarea>
                              </div>
                              <div class="form-group">
                                <label for="project_what">What?</label>
                                <textarea rows="4" class="form-control" id="project_what" name="project_what"></textarea>
                              </div>
                              <div class="form-group">
                                <label for="start_date">Start Date (YYYY-MM-DD):</label>
                                <input type="text" class="form-control" id="start_date" name="start_date" placeholder="yyyy-mm-dd">
                              </div>
                              <div class="form-group">
                                <label for="end_date">End Date (YYYY-MM-DD):</label>
                                <input type="text" class="form-control" id="end_date" name="end_date" placeholder="yyyy-mm-dd">
                              </div>
                              <div class="form-group">
                                <label for="next_milestone_date">Next Milestone Date (YYYY-MM-DD):</label>
                                <input type="text" class="form-control" id="next_milestone_date" name="next_milestone_date" placeholder="yyyy-mm-dd">
                              </div>
                            </div>
                          </div>
                      
                          <div class="col-md-6">
                            <!-- Second column of form fields -->
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="phase">Phase:</label>
                                  <select name="phase_id_fk" id="phase_id_fk" class="form-control">
                                    <% phases.forEach(function(phase){ %>
                                      <option value="<%= phase.id %>"><%= phase.phase_name %></option>
                                    <% }) %>
                                  </select>
                                </div>
                              </div>
                              <div class="form-group">
                                <textarea name="pitch_message" rows=4 id="pitch_message" style="width:400px;" placeholder="Enter your pitch message here"></textarea>
                                </div>
                              </div>
                              <div id="otherPhaseFields">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="priority">Priority:</label>
                                  <select name="priority_id_fk" id="priority_id_fk" class="form-control">
                                    <% priorities.forEach(function(priority){ %>
                                      <option value="<%= priority.id %>"><%= priority.priority_name %></option>
                                    <% }) %>
                                  </select>
                                </div>
                              </div>
                            </div>
                      
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="sponsor">Sponsor:</label>
                                  <select name="sponsor_id_fk" id="sponsor_id_fk" class="form-control">
                                    <% sponsors.forEach(function(sponsor){ %>
                                      <option value="<%= sponsor.id %>"><%= sponsor.last_name %>, <%= sponsor.first_name %></option>
                                    <% }) %>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="prime">Prime:</label>
                                  <select name="prime_id_fk" id="prime_id_fk" class="form-control">
                                    <% primes.forEach(function(prime){ %>
                                      <option value="<%= prime.id %>"><%= prime.last_name %>, <%= prime.first_name %></option>
                                    <% }) %>
                                  </select>
                                </div>
                              </div>
                            </div>
                      
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="effort">Effort (PH)</label>
                                  <input type="text" class="form-control" id="effort" name="effort" style="width:100px;">
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="benefit">Benefit (ROI or $)</label>
                                  <input type="text" class="form-control" id="benefit" name="benefit" style="width:100px;">
                                </div>
                              </div>
                            </div>
                      
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="impact">Impact:</label>
                                  <select name="impact" id="impact" class="form-control">
                                    <% for (var i = 1; i <= 10; i++) { %>
                                      <option value="<%= i %>"><%= i %></option>
                                    <% } %>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="complexity">Complexity:</label>
                                  <select name="complexity" id="complexity" class="form-control">
                                    <% for (var i = 1; i <= 10; i++) { %>
                                      <option value="<%= i %>"><%= i %></option>
                                    <% } %>
                                  </select>
                                </div>
                              </div>
                            </div>
                      
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="project_cost">Estimated Cost</label>
                                  <input type="text" class="form-control" id="project_cost" name="project_cost" value="0">
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label for="project_tags">Tags (comma separated)</label>
                                  <input type="text" class="form-control" id="project_tags" name="project_tags">
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                        <!-- Add more rows and columns if needed -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary waves-effect" data-dismiss="modal">Close</button>
                            <button class="btn btn-primary w-md waves-effect waves-light" type="submit">Submit</button>
                            <!-- if edit, add delete button -->
                            <!-- <button class="btn btn-danger w-md waves-effect waves-light" onClick='openDeleteModal()' type="button">Delete</button> -->
                            <!-- if edit, add delete button -->
                        </div>
                    </form>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

<%- contentFor('FooterJs') %>
<script src="public/assets/plugins/peity-chart/jquery.peity.min.js"></script>
<script src="public/assets/plugins/d3/d3.min.js"></script>
<script src="public/assets/plugins/c3/c3.min.js"></script>
<script src="public/assets/plugins/jquery-knob/excanvas.js"></script>
<script src="public/assets/plugins/jquery-knob/jquery.knob.js"></script>
<script src="public/assets/pages/dashboard.js"></script>

<%- contentFor('BottomJs') %>

<script>
  function loadProject(project_id) {
    window.location.replace("/projects/cockpit/" + project_id);
  }

  function loadFunnel() {
    window.location.replace("/projects/funnel/view/");
    // window.location.replace('/projects/funnel/view/'+ project_id+'/');
  }
  function loadRadar() {
    window.location.replace("/projects/radar/view/");
  }
  function loadFlightPlan() {
    window.location.replace("/projects/flight/view/");
  }
</script>
